clear all
% k = [0.11,0.1532, 0.2154]
% ve = [2647.2, 2922.4, 4344.3]
% mu = 1700


%Ariane test

ep = [[0.1101, 2647.2]; [0.1532, 2922.4]; [0.2154, 4344.3]];
m_0 = [1.8e5; 5e4; 1.5e4];
m_u = 1700;
V = 11527;
m_3 = @(m) ep(3, 2) * log((m_u+(1+ep(3, 1))*m(3))/(m_u+ep(3, 1)*m(3)));
m_2 = @(m) ep(2, 2) * log((m_u+(1+ep(3, 1))*m(3)+(1+ep(2, 1))*m(2))/(m_u+(1+ep(3, 1))*m(3)+ep(2, 1)*m(2)));
m_1 = @(m) ep(1, 2) * log((m_u+(1+ep(3, 1))*m(3)+(1+ep(2, 1))*m(2)+(1+ep(1, 1))*m(1))/(m_u+(1+ep(3, 1))*m(3)+(1+ep(2, 1))*m(2)+ep(1, 1)*m(1)));
F = @(m) [m_u + dot((1 + ep(1:3, 1)), m); -V + m_1(m) + m_2(m) + m_3(m)];
domain = [[1e5, 2e5]; [1e4, 5e4]; [5e3, 1e4]];
m_s = [145349; 31215; 7933]; % masses d'ergols

[m,~,~,k] = SQP(m_0, F, 1e-6, domain, 30, 2)
